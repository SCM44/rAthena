//===== rAthena Script =======================================
//= Memorial Society combined entrance NPC (kRo Zero)
//============================================================

prt_fild06,37,197,5	script	Memorial Association Member#0	4_F_GON,4,4,{

	if(BaseLevel < 70){
		mes "[Memorial Association Member]";
		mes "Hello there. If you are interested in exploring more Instances, please come back to be when you reach level 70+.";
		close;
	}
	if(isbegin_quest(12437) == 0){
		mes "[Memorial Association Member]";
		mes "Oh, I'm happy that you may be interested in my story?";
		next;
		mes "[Memorial Association Member]";
		mes "Our Memorial Association is similar to the Zero Academy, but it has a bit of a maniac tendency.";
		next;
		mes "[Memorial Association Member]";
		mes "Our main purpose is to investigate the distorted dimensions that exist in this world, and as a result, we naturally began to specialize in the study of Memorial Dungeon aka Instances.";
		next;
		select("Another dangerous thing to do...");
		npctalk "Oh man, that's why I don't like quick-witted kids.",strnpcinfo(0),bc_self;
		mes "[Memorial Association Member]";
		mes "... (Could it be, it's not dangerous at all.)";
		next;
		select("My thoughts and conversations have changed!");
		mes "[Memorial Association Member]";
		mes "Well anyway. Three unstable dimensional passages have been discovered in our new land. Someone wanted to talk about the need to maintain it.";
		next;
		select("Maintenance?");
		mes "[Memorial Association Member]";
		mes "The momentum inside the instances seems to be weakening due to the purification activities of the adventurers. This seems to be a common feature of the naturally occurring instances.";
		next;
		mes "[Memorial Association Member]";
		mes "To summarize it in an easy-to-understand way. Adventurer-sama must go and make a mess, so that the power of the rift can be prevented from twisting strongly. This is it. Will you help us?";
		next;
		switch(select("Great!","Nope?")){
		
			case 1:
				mes "[Memorial Association Member]";
				mes "Thank you. Recently discovered and managed by me, there are a total of 3 instances. ^ff0000Ant Hell, Izlude Deepsea & Sunken Ship.^000000";
				next;
				mes "[Memorial Association Member]";
				mes "Some civilians got into and out of the warped dimension of these three areas, and they've had accidents, so they're closed now and we're in full control.";
				next;
				mes "[Memorial Association Member]";
				mes "From now on, you can use the dimension shifter next to me and me to enter and exit those three places. Please come back to me when you are ready to leave.";
				setquest 12437;
				completequest 12437;
				close;
			
			case 2:
				mes "[Memorial Association Member]";
				mes "Oh well, if you're busy, there's nothing you can do about it. Next time, if you're willing to save the world, please come to me.";
				close;
		}
	}
	mes "^ff0000If you attempt to tame any monsters, it will not count as a kill. Please be careful.^000000";
    next;
	mes "["+strnpcinfo(1)+"]";
	mes "So which dungeon would you like to choose?";
	next;	
	switch(select("Ant Hell [70+]:Izlude Deepsea [80+]:Sunken Ship [99+]")) {
		case 1: 
			.@md_name$ = "Ant Hell";
			switch(checkquest(12438,PLAYTIME)) {
				case -1: break;
				case 0:
				case 1:
					mes "["+strnpcinfo(1)+"]";
					mes "Sorry, but the entry period to the "+.@md_name$+" has expired.";
					mes "Take a rest while waiting for the dungeon to be available again.";
					next;
					switch(select("Reset cooldown (100,000z)","No thanks.")){
						
						case 1:
							if(zeny < 100000){
								mes "["+strnpcinfo(1)+"]";
								mes "You want to reset the cooldown, it will cost you 100,000 zeny.";
								close;
							}
							mes "["+strnpcinfo(1)+"]";
							mes "You really don't have any patience...I'll be taking the zeny and reset the instance for you.";
							mes "You may enter.";
							set zeny,zeny-100000;
							erasequest 12438;
							close;
						
						case 2:
							mes "["+strnpcinfo(1)+"]";
							mes "See you around then.";
							close;
					}
				case 2:
					erasequest 12438;
			}
			if (is_party_leader() == false) {
					mes "["+strnpcinfo(1)+"]";
					mes "Please tell your Party Leader to create the instance.";
					close;
			}
			instance_create(.@md_name$);
			mes "[Memorial Association Member]";
			mes "The Memorial Dungeon of "+.@md_name$+" has been created.";
			mes "You may now enter.";
			close;
	
		case 2:
			if(BaseLevel < 80){
				mes "[Memorial Association Member]";
				mes "Hello there. If you are interested in exploring this instance, please come back to be when you reach level 80.";
				close;
			}
			.@md_name$ = "Izlude Deepsea";
			switch(checkquest(12439,PLAYTIME)) {
				case -1: break;
				case 0:
				case 1:
					mes "["+strnpcinfo(1)+"]";
					mes "Sorry, but the entry period to the "+.@md_name$+" has expired.";
					mes "Take a rest while waiting for the dungeon to be available again.";
					next;
					switch(select("Reset cooldown (100,000z)","No thanks.")){
						
						case 1:
							if(zeny < 300000){
								mes "["+strnpcinfo(1)+"]";
								mes "You want to reset the cooldown, it will cost you 100,000 zeny.";
								close;
							}
							mes "["+strnpcinfo(1)+"]";
							mes "You really don't have any patience...I'll be taking the zeny and reset the instance for you.";
							mes "You may enter.";
							set zeny,zeny-100000;
							erasequest 12439;
							close;
						
						case 2:
							mes "["+strnpcinfo(1)+"]";
							mes "See you around then.";
							close;
					}
					
				case 2:
					erasequest 12439;
			}
			if (is_party_leader() == false) {
					mes "["+strnpcinfo(1)+"]";
					mes "Please tell your Party Leader to create the instance.";
					close;
			}
			instance_create(.@md_name$);
			mes "[Memorial Association Member]";
			mes "The Memorial Dungeon of "+.@md_name$+" has been created.";
			mes "You may now enter.";
			close;
		
		case 3:
			if(BaseLevel < 99){
				mes "[Memorial Association Member]";
				mes "Hello there. If you are interested in exploring this instance, please come back to be when you reach level 99.";
				close;
			}
			.@md_name$ = "Sunken Ship";
			switch(checkquest(12440,PLAYTIME)) {
				case -1: break;
				case 0:
				case 1:
					mes "["+strnpcinfo(1)+"]";
					mes "Sorry, but the entry period to the "+.@md_name$+" has expired.";
					mes "Take a rest while waiting for the dungeon to be available again.";
					next;
					switch(select("Reset cooldown (100,000z)","No thanks")){
						
						case 1:
							if(zeny < 100000){
								mes "["+strnpcinfo(1)+"]";
								mes "You want to reset the cooldown, it will cost you 100,000 zeny.";
								close;
							}
							mes "["+strnpcinfo(1)+"]";
							mes "You really don't have any patience...I'll be taking the zeny and reset the instance for you.";
							mes "You may enter.";
							set zeny,zeny-100000;
							erasequest 12440;
							close;
						
						case 2:
							mes "["+strnpcinfo(1)+"]";
							mes "See you around then.";
							close;
					}
					
				case 2:
					erasequest 12440;
			}
			if (is_party_leader() == false) {
					mes "["+strnpcinfo(1)+"]";
					mes "Please tell your Party Leader to create the instance.";
					close;
			}
			instance_create(.@md_name$);
			mes "[Memorial Association Member]";
			mes "The Memorial Dungeon of "+.@md_name$+" has been created.";
			mes "You may now enter.";
			close;
	}

OnTouch:
	npctalk "Adventurer, would you like to help us explore the new dungeons?",strnpcinfo(0),bc_self;
	end;

OnInit:
	questinfo QTYPE_QUEST,QMARK_YELLOW,"isbegin_quest(12437) == 0 && BaseLevel >= 70";
end;

}

prt_fild06,41,197,5	script	Dimensional Shifter#ins	PORTAL,{

	mes "^ff0000If you attempt to tame any monsters, it will not count as a kill. Please be careful.^000000";
    next;
	mes "["+strnpcinfo(1)+"]";
	mes "Which dungeon did you reserve?";
	next;
	switch(select("Ant Hell [70+]:Izlude Deepsea [80+]:Sunken Ship [99+]")) {
		case 1: 
			.@md_name$ = "Ant Hell";
			switch(checkquest(12438,PLAYTIME)) {
				case 0:
				case 1:
					mes "Sorry, but the entry period to the "+.@md_name$+" has expired.";
					close;
			}
			switch( instance_enter(.@md_name$) ) {
                    case IE_NOMEMBER:
                        end;
                    case IE_NOINSTANCE:
                        mes "There is no Memorial Dungeon registered.";
                        close;
                    case IE_OTHER:
                        mes "An unknown error has occurred.";
                        close;
                    case IE_OK:
						mes "[Calm Scientist]";
                        mes "I'll meet you there!";
                        mapannounce "prt_fild06", "" + strcharinfo(0) + " of the party, " + getpartyname( getcharid(1) ) + ", is entering the " + .@md_name$ + ".", bc_map, 0xFF99;
                        setquest 12438;
                }
				close;
	
		case 2:
			.@md_name$ = "Izlude Deepsea";
			switch(checkquest(12439,PLAYTIME)) {
				case 0:
				case 1:
					mes "Sorry, but the entry period to the "+.@md_name$+" has expired.";
					close;
			}
			switch( instance_enter(.@md_name$) ) {
                    case IE_NOMEMBER:
                        end;
                    case IE_NOINSTANCE:
                        mes "There is no Memorial Dungeon registered.";
                        close;
                    case IE_OTHER:
                        mes "An unknown error has occurred.";
                        close;
                    case IE_OK:
						mes "[Calm Scientist]";
                        mes "I'll meet you there!";
                        mapannounce "prt_fild06", "" + strcharinfo(0) + " of the party, " + getpartyname( getcharid(1) ) + ", is entering the " + .@md_name$ + ".", bc_map, 0xFF99;
						setquest 12439;
                }
				close;
		
		case 3:
			.@md_name$ = "Sunken Ship"; 
			switch(checkquest(12440,PLAYTIME)) {
				case 0:
				case 1:
					mes "Sorry, but the entry period to the "+.@md_name$+" has expired.";
					close;
			}
			switch( instance_enter(.@md_name$) ) {
                    case IE_NOMEMBER:
                        end;
                    case IE_NOINSTANCE:
                        mes "There is no Memorial Dungeon registered.";
                        close;
                    case IE_OTHER:
                        mes "An unknown error has occurred.";
                        close;
                    case IE_OK:
						mes "[Calm Scientist]";
                        mes "I'll meet you there!";
                        mapannounce "prt_fild06", "" + strcharinfo(0) + " of the party, " + getpartyname( getcharid(1) ) + ", is entering the " + .@md_name$ + ".", bc_map, 0xFF99;
                        setquest 12440;
                }
				close;
	}
	
}
